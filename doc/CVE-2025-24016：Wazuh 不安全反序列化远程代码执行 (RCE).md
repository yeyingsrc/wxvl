#  CVE-2025-24016：Wazuh 不安全反序列化远程代码执行 (RCE)   
 TtTeam   2025-03-04 00:09  
  
        Wazuh 服务器中存在一个不安全的反序列化漏洞，可通过在 DAPI 请求/响应中注入未经清理的字典来执行远程代码。此问题源于 DistributedAPI 参数被序列化为 JSON，然后使用 framework/wazuh/core/cluster/common.py 中的 as_wazuh_object 函数进行反序列化的方式。  
  
  
        如果攻击者将未清理的字典注入 DAPI 请求或响应中，他们可以制作未处理的异常（**unhandled_exc**），从而允许任意 Python 代码执行。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB0ATrVgw6CkmT9n6bicD3BDz3Iibd0xeiaMiaxjTzzhYKb2GmFreHdian39qmhqqTnR0M3WDuUgES6bGibQ/640?wx_fmt=png&from=appmsg "")  
  
安装：  
  
```
git clone https://github.com/0xjessie21/CVE-2025-24016.git
cd CVE-2025-24016/
pip install -r requirements.txt
```  
  
  
使用：  
```
python3 CVE-2025-24016.py -h
```  
  
  
  
  
  
