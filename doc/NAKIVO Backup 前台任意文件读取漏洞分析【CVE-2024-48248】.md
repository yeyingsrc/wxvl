#  NAKIVO Backup å‰å°ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´åˆ†æã€CVE-2024-48248ã€‘   
åŸåˆ› Mstir  æ˜Ÿæ‚¦å®‰å…¨   2025-03-04 05:02  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_jpg/lSQtsngIibibSOeF8DNKNAC3a6kgvhmWqvoQdibCCk028HCpd5q1pEeFjIhicyia0IcY7f2G9fpqaUm6ATDQuZZ05yw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
ç‚¹å‡»ä¸Šæ–¹  
è“å­—  
å…³æ³¨æˆ‘ä»¬ å¹¶è®¾ä¸º  
æ˜Ÿæ ‡  
## 0x00 å‰è¨€  
  
**NAKIVO Backup & Replication æ˜¯ä¸€æ¬¾ä¸“æ³¨äºè™šæ‹ŸåŒ–ã€äº‘ç«¯åŠæ··åˆç¯å¢ƒçš„å¤‡ä»½ä¸ç¾éš¾æ¢å¤çš„è§£å†³æ–¹æ¡ˆï¼Œé«˜çº§äº‘é›†æˆï¼Œå†…ç½® VMware ç›‘æ§åŠŸèƒ½ï¼Œå¯å®æ—¶ç›‘æ§ CPUã€å†…å­˜å’Œç£ç›˜çš„ä½¿ç”¨æƒ…å†µï¼ŒåŸºäº Web çš„ç›´è§‚ç•Œé¢ï¼Œå¯ä»ä»»ä½•ä½ç½®å’Œä»»ä½•è®¾å¤‡è®¿é—®è§£å†³æ–¹æ¡ˆï¼ŒåŸºäºç­–ç•¥çš„è‡ªåŠ¨åŒ–ï¼Œé€šè¿‡è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½å’Œ åœ¨ä¸ç­–ç•¥è§„åˆ™åŒ¹é…çš„è®¡ç®—æœºä¸Šå¤åˆ¶ã€‚**  
  
****  
**FofaæŒ‡çº¹ : app="NAKIVO-Backup-Replication"**  
  
****  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5ebt4r9tZAUTv5NPn35kAhBm8j3eHU52DFybss2Uzr18R3KMRP0axVn7whXk1rWccCWuUx48fLzjg/640?wx_fmt=png&from=appmsg "")  
  
![image.png](https://mmbiz.qpic.cn/sz_mmbiz_jpg/uicic8KPZnD5ebt4r9tZAUTv5NPn35kAhBySViaV8GlG4cuX3Z2axNv2rFCKp9e3Dsu7IpW0lPKaicfJGO90hSOdCw/640?wx_fmt=other&from=appmsg "")  
  
æ¡†æ¶:Tomcat springframework  
## 0x01 æ¼æ´ç ”ç©¶&å¤ç°  
æƒ³è¦ç ”ç©¶è¯¥è®¾å¤‡ï¼Œæˆ‘ä»¬éœ€è¦ä¸‹è½½ V10.11.3 çš„ç‰ˆæœ¬ï¼Œä½†åœ¨å®˜ç½‘æ²¡æœ‰æ‰¾åˆ°Windowsç¨‹åºçš„å®‰è£…ç•Œé¢äº†ï¼Œä½†æ˜¯èƒ½æ‰¾åˆ°OVA è™šæ‹Ÿæœºæ–‡ä»¶çš„ä¸‹è½½é“¾æ¥ï¼Œé‚ä¸‹è½½ä¸€ä¸‹è¿›è¡Œç ”ç©¶ï¼ˆéœ€é­”æ³•ï¼Œä¸ç„¶ä¸‹å¾ˆæ…¢ï¼‰.https://nbr-va.s3-us-west-2.amazonaws.com/NAKIVO_Backup_Replication_VA_v10.11.3_Full_Solution_TRIAL.ova  
**.OVAæ–‡ä»¶ä¸‹ä¸‹æ¥ä¹‹åï¼Œç›´æ¥æ‹–è¿›VMware è™šæ‹Ÿæœºä¸­å³å¯ç›´æ¥è¿è¡Œï¼Œå…¶æè¿°ä¸­å¸¦äº†è™šæ‹Ÿæœºä¸»æœºè´¦å·åŠå¯†ç .**  
  
****```
Ubuntu 22.04 Server VA with NAKIVO Backup and Replication 10.11 preinstalledVA login: nkvuserVA password: QExS-6b%3D
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/uicic8KPZnD5ebt4r9tZAUTv5NPn35kAhBT7rcTZd26MspibZAfO0ZCDj1b1SVHD7Vuic5ygNicibXwHUF0BqPoJV58Q/640?wx_fmt=webp&from=appmsg "")  
  
æ ¹æ®ä¸€äº›è·¯ç”±åˆ†æï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†å¦‚ä¸‹ä»£ç ```
@Service
@RemotingApiAction(STPreLoadManagement.class)publicÂ classÂ STPreLoadFacadeÂ Â implementsÂ STPreLoadManagement{

[..Truncated..]

@RemotingApiMethod
publicÂ byte[] getImageByPath(String path)Â throwsÂ MspManagementException {
Â Â tryÂ {
Â  Â Â returnÂ this.brandingService.getImageByPath(path);
Â  }Â catchÂ (Throwable t) {
Â  Â Â throwÂ newÂ MspManagementException(t);
Â  }Â 

```  
  
  
å…¶é€šè¿‡ä¼ å‚method = getImageByPath æ¥è¿›å…¥åˆ°è¯¥æ–¹æ³•ä¸­ï¼Œç„¶åè¿›å…¥åˆ°getImageByPath æ–¹æ³•ä¹‹ä¸­ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•  
  
```
publicÂ byte[] getImageByPath(String path)Â throwsÂ IOException {
Â  String newPath = path.replace("/c",Â "userdata");
Â  File file =Â newÂ File(newPath);
Â Â returnÂ FileUtils.readFileToByteArray(file);
}

```  
  
  
è¯¥æ–¹æ³•ä½¿ç”¨ getImageByPath é‡‡ç”¨å‚æ•° path å¹¶å°†è¯¥è·¯å¾„å°†æ–‡ä»¶è¯»å–åˆ°å­—èŠ‚æ•°ç»„  
  
Payload:  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5ebt4r9tZAUTv5NPn35kAhBgb59Xwq4MTibdueAsgia7GTcWelGFwOUfMHWiblezg0EYlicVQSh5Dx84A/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5ebt4r9tZAUTv5NPn35kAhBwsNNJKzjibHduYvY5cmxML5Q8gctsgz6XNSnDwYaecHnj7GRfrF3xwQ/640?wx_fmt=png&from=appmsg "")  
  
åˆ©ç”¨è„šæœ¬:  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5ebt4r9tZAUTv5NPn35kAhBibYfUUXxic6JmNpvdZNyXGOMkasmgduRGbPqziceu3d07YWibeT4tficVZA/640?wx_fmt=png&from=appmsg "")  
## 0x02 å…³æ³¨å…¬ä¼—å·  
  
**æ ‡ç­¾:ä»£ç å®¡è®¡ï¼Œ0dayï¼Œæ¸—é€æµ‹è¯•ï¼Œç³»ç»Ÿï¼Œé€šç”¨ï¼Œ0dayï¼Œé—²é±¼ï¼Œè½¬è½¬**  
  
**POCå…³æ³¨å…¬ä¼—å·å‘é€ 250304 è·å–!**  
  
****  
  
****  
**å¼€äº†ä¸ªæ˜Ÿæ‚¦å®‰å…¨å…¬å¼€äº¤æµ6ç¾¤ï¼ŒğŸˆ²å‘å…¬ä¼—å·ï¼Œçº¯ç²¹ç ”ç©¶æŠ€æœ¯ï¼Œè¿›äº†å…¶ä»–å…¬å¼€ç¾¤çš„ä¸è¦é‡å¤è¿›äº†.**  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_jpg/uicic8KPZnD5cW9NgUnN7cGGZxZqlp453aOPiaffwajFmfm8icbia6ZoHFD868yp9cnJAibVsuqiaxib7X3ZoOeQ1hpGGQ/640?wx_fmt=jpeg&from=appmsg "")  
  
**å…è´£å£°æ˜:æ–‡ç« ä¸­æ¶‰åŠçš„ç¨‹åº(æ–¹æ³•)å¯èƒ½å¸¦æœ‰æ”»å‡»æ€§ï¼Œä»…ä¾›å®‰å…¨ç ”ç©¶ä¸æ•™å­¦ä¹‹ç”¨ï¼Œè¯»è€…å°†å…¶ä¿¡æ¯åšå…¶ä»–ç”¨é€”ï¼Œç”±è¯»è€…æ‰¿æ‹…å…¨éƒ¨æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œæ–‡ç« ä½œè€…å’Œæœ¬å…¬ä¼—å·ä¸æ‰¿æ‹…ä»»ä½•æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œæœ›å‘¨çŸ¥ï¼ï¼!**  
  
